\documentclass[../../sets-and-functions.ftl.tex]{subfiles}

\typeout{
  \begin{forthel}
    [readtex FLib/BasicNotions/src/sets-and-functions/sections/01_sets/01_sets.ftl.tex]

    [checkconsistency off]

    [synonym function/-s]
  \end{forthel}
}

\begin{document}
  \section{Functions}

  \subsection{Function axioms}

  \begin{forthel}
    Let $u,v,w$ denote elements.
    Let $x,y,z$ denote sets.
    Let $f,g,h$ denote functions.

    Let the domain of $f$ stand for $\dom(f)$.
    Let the value of $f$ at $u$ stand for $f(u)$.
    Let $\val{f}{u}$ stand for $f(u)$.

    \begin{definition}
      A value of $f$ is an object $v$ such that $v = f(u)$ for some $u \in \dom(f)$.
    \end{definition}

    \begin{definition}
      A fixed point of $f$ is an element $u$ of the domain of $f$ such that $f(u) = u$.
    \end{definition}
  \end{forthel}

  Note that the following two axioms are already hard-coded into Naproche.

  \begin{forthel}
    \begin{axiom}[Function extensionality]
      Let $f,g$ be functions.
      If $\dom(f) = \dom(g)$ and $f(u) = g(u)$ for all $u \in \dom(f)$ then $f = g$.
    \end{axiom}

    \begin{axiom}[SF 02 01 459591]
      The domain of any function is a set.
    \end{axiom}

    \begin{axiom}[SF 02 01 303112]
      Every value of $f$ is an element.
    \end{axiom}
  \end{forthel}

  \textbf{Important note:} The current version of Naproche\footnote{Isabelle/Naproche 2021} allows to define functions \textit{manually} whose values are not elements.
  Hence such a manual definition will introduce an inconsistency to the theory.
  Fortunately the ATP is not able to deduce the existence of a function which contradicts this axiom.
  So as long as you do not define a non-element-valued function yourself, there will not be any consistency issues (assuming that our is consistent at all).

  \begin{forthel}
    \begin{axiom}[Replacement]
      Let $f$ be a function. % Without this line the following class term would not be parsed successfully.
      There exists a set $y$ such that $y = \{ f(u) \mid u \in \dom(f) \}$.
    \end{axiom}
  \end{forthel}


  \subsection{The range}

  \begin{forthel}
    \begin{definition}
      Let $f$ be a function.
      $\range(f)$ is the set $y$ such that $y = \{ f(u) \mid u \in \dom(f) \}$.
    \end{definition}

    Let the range of $f$ stand for $\range(f)$.


    \begin{proposition}[SF 02 01 324423]
      $v$ is a value of $f$ iff $v \in \range(f)$.
    \end{proposition}
    \begin{proof}
      Case $v$ is a value of $f$.
        Take $u \in \dom(f)$ such that $v = f(u)$.
        $v$ is an element.
        Hence $v \in \range(f)$.
      End.

      Case $v \in \range(f)$.
        Then $v = f(u)$ for some $u \in \dom(f)$.
        Hence $v$ is a value of $f$.
      End.
    \end{proof}
  \end{forthel}


  \subsection{Functions between sets}

  \begin{forthel}
    \begin{definition}
      A function of $x$ is a function $f$ such that $\dom(f) = x$.
    \end{definition}

    \begin{definition}
      A function to $y$ is a function $f$ such that $f(u) \in y$ for all $u \in \dom(f)$.
    \end{definition}

    Let a function from $x$ to $y$ stand for a function $f$ of $x$ such that $f$ is a function to $y$.
    Let $f: x \to y$ stand for $f$ is a function from $x$ to $y$.

    \begin{proposition}[SF 02 01 694542]
      Let $f$ be a function from $x$ to $y$.
      Then $\range(f) \subseteq y$.
    \end{proposition}
    \begin{proof}
      Let $v \in \range(f)$.
      Take $u \in x$ such that $v = f(u)$.
      Then $v \in y$.
    \end{proof}

    \begin{definition}
      A function onto $y$ is a function $f$ such that $y = \range(f)$.
    \end{definition}

    \begin{definition}
      A function from $x$ onto $y$ is a function $f$ of $x$ such that $f$ is a function onto $y$.
    \end{definition}

    Let $f: x \onto y$ stand for $f$ is a function from $x$ onto $y$.

    \begin{proposition}[SF 02 01 677451]
      $f$ is a function onto $\range(f)$.
    \end{proposition}

    \begin{proposition}[SF 02 01 495468]
      Let $f$ be a function onto $y$.
      Then $f$ is a function to $y$.
    \end{proposition}
    \begin{proof}
      Let $u \in \dom(f)$.
      Then $f(u) \in \range(f)$.
      Hence $f(u) \in y$.
    \end{proof}

    \begin{definition}
      A function on $x$ is a function from $x$ to $x$.
    \end{definition}

    \begin{definition}
      $f$ is one to one iff for all $u,v \in \dom(f)$ if $f(u) = f(v)$ then $u = v$.
    \end{definition}

    \begin{definition}
      A function into $y$ is an one to one function to $y$.
    \end{definition}

    \begin{definition}
      A function from $x$ into $y$ is a function $f$ of $x$ such that $f$ is a function into $y$.
    \end{definition}

    Let $f: x \into y$ stand for $f$ is a function from $x$ into $y$.

    \begin{definition}
      A bijection between $x$ and $y$ is a one to one function $f$ from $x$ onto $y$.
    \end{definition}

    Let a bijection from $x$ to $y$ stand for a bijection between $x$ and $y$.

    \begin{proposition}[SF 02 01 717927]
      Let $f$ be a function from $x$ into $y$.
      Then $f$ is a bijection between $x$ and $\range(f)$.
    \end{proposition}
    \begin{proof}
      $f$ is one to one and $f$ is a function from $x$ onto $\range(f)$.
      Hence $f$ is a bijection between $x$ and $\range(f)$.
    \end{proof}

    \begin{definition}
      A permutation of $x$ is a bijection between $x$ and $x$.
    \end{definition}
  \end{forthel}


  \subsection{The identity function}

  \begin{forthel}
    \begin{lemma}
      There is a function $\iota$ of $x$ such that $\iota(u) = u$ for all $u \in x$.
    \end{lemma}
    \begin{proof}
      Define $\iota(u) = u$ for $u \in x$.
    \end{proof}

    \begin{definition}
      $\id{x}$ is the function of $x$ such that $\id{x}(u) = u$ for all $u \in x$.
    \end{definition}

    Let the identity function on $x$ stand for $\id{x}$.

    \begin{proposition}[SF 02 01 848243]
      $\id{x}$ is a permutation of $x$.
    \end{proposition}
    \begin{proof}
      (1) $\id{x}$ is a function of $x$.

      (2) $\id{x}$ is a function onto $x$.
      Proof.
        Let $v \in x$.
        Then $v = \id{x}(v)$.
        Hence $v \in \range(\id{x})$.
      Qed.

      (3) $\id{x}$ is a function into $x$.
      Proof.
        Let $v,v' \in x$.
        Assume $\id{x}(v) = \id{x}(v')$.
        Then $v = v'$.
      Qed.
    \end{proof}
  \end{forthel}


  \subsection{Constant functions}

  \begin{forthel}
    \begin{lemma}
      Let $x$ be a set and $v$ be an element.
      There is a function $c$ of $x$ such that $c(u) = v$ for all $u \in x$.
    \end{lemma}
    \begin{proof}
      Define $c(u) = v$ for $u \in x$.
    \end{proof}

    \begin{definition}
      $\const{x}{v}$ is the function of $x$ such that $\const{x}{v}(u) = v$ for all $u \in x$.
    \end{definition}

    Let the constant function on $x$ with value $v$ stand for $\const{x}{v}$.

    \begin{proposition}[SF 02 01 180417]
      Assume $v \in y$.
      Then $\const{x}{v}$ is a function from $x$ to $y$.
    \end{proposition}
    \begin{proof}
      We have $\dom(\const{x}{v}) = x$ and $\const{x}{v}(u) = v$ for all $u \in x$.
      Hence $\const{x}{v}(u)$ is an element of $y$ for all $u \in x$.
      Thus $\range(\const{x}{v}) \subseteq y$.
      Therefore $\const{x}{v}$ is a function from $x$ to $y$.
    \end{proof}

    \begin{definition}
      Let $f$ be a function.
      $f$ is constant iff there exists an object $v$ such that $f(u) = v$ for all $u \in \dom(f)$.
    \end{definition}

    \begin{proposition}[SF 02 01 359618]
      $\const{x}{v}$ is constant.
    \end{proposition}
    \begin{proof}
      We have $\const{x}{v}(u) = v$ for all $u \in x$.
      Hence the thesis.
    \end{proof}
  \end{forthel}


  \subsection{Composition}

  \begin{forthel}
    \begin{lemma}
      Assume $\range(f) \subseteq \dom(g)$.
      Then there is a function $h$ such that $\dom(h) = \dom(f)$ and $h(u) = g(f(u))$ for all $u \in \dom(h)$.
    \end{lemma}
    \begin{proof}
      Define $h(u) = g(f(u))$ for $u \in \dom(f)$.
    \end{proof}

    \begin{definition}
      Assume $\range(f) \subseteq \dom(g)$.
      $g \circ f$ is the function $h$ such that $\dom(h) = \dom(f)$ and $h(u) = g(f(u))$ for all $u \in \dom(h)$.
    \end{definition}

    Let the composition of $g$ and $f$ stand for $g \circ f$.

    \begin{proposition}[SF 02 01 289732]
      Let $f$ be a function from $x$ to $y$ and $g$ be a function from $y$ to $z$.
      Then $g \circ f$ is a function from $x$ to $z$.
    \end{proposition}
    \begin{proof}
      (1) $g \circ f$ is a function of $x$.
      Indeed $\dom(g \circ f) = \dom(f) = x$.

      (2) $\range(g \circ f) \subseteq z$.
      Proof.
        Let $w \in \range(g \circ f)$.
        Take $u \in x$ such that $(g \circ f)(u) = w$.
        Then $w = g(f(u))$.
        We have $f(u) \in y$.
        Hence $w \in z$.
      Qed.
    \end{proof}

    \begin{proposition}[SF 02 01 718601]
      Let $f$ be a function from $x$ to $y$.
      Then $f \circ \id{x} = f = \id{y} \circ f$.
    \end{proposition}
    \begin{proof}
      $x$ is the domain of $f \circ \id{x}$ and the domain of $f$ and the domain of $\id{y} \circ f$.
      $(f \circ \id{x})(u) = f(\id{x}(u)) = f(u) = \id{y}(f(u)) = (\id{y} \circ f)(u)$ for all $u \in x$.
      Hence the thesis (by function extensionality).
    \end{proof}

    \begin{proposition}[SF 02 01 558108]
      Let $f$ be a function from $x$ to $y$ and $v$ be an element.
      Then $\const{y}{v} \circ f = \const{x}{v}$.
    \end{proposition}
    \begin{proof}
      We have $\dom(\const{y}{v} \circ f) = \dom(f) = x = \dom(\const{x}{v})$.
      $(\const{y}{v} \circ f)(u) = \const{y}{v}(f(u)) = v = \const{x}{v}(u)$ for all $u \in x$.
      Hence the thesis (by function extensionality).
    \end{proof}

    \begin{proposition}[SF 02 01 795869]
      Let $f$ be a function from $y$ to $z$ and $v \in y$.
      Then $f \circ \const{x}{v} = \const{x}{f(v)}$.
    \end{proposition}
    \begin{proof}
      We have $\dom(f \circ \const{x}{v}) = \dom(\const{x}{v}) = x = \dom(\const{x}{f(v)})$.
      $(f \circ \const{x}{v})(u) = f(\const{x}{v}(u)) = f(v) = \const{x}{f(v)}(u)$ for all $u \in x$.
      Hence the thesis (by function extensionality).
    \end{proof}

    \begin{proposition}[SF 02 01 205975]
      Let $f$ be a function from $x$ onto $y$ and $g$ be a function from $y$ onto $z$.
      Then $g \circ f$ is a function from $x$ onto $z$.
    \end{proposition}
    \begin{proof}
      $g \circ f$ is a function of $x$.

      Let us show that $g \circ f$ is a function onto $z$.
        Let $w \in z$.
        Take $v \in y$ such that $w = g(v)$.
        Take $u \in x$ such that $v = f(u)$.
        Then $w = g(f(u)) = (g \circ f)(u)$.
      End.
    \end{proof}

    \begin{proposition}[SF 02 01 784576]
      Let $f$ be a function from $x$ into $y$ and $g$ be a function from $y$ into $z$.
      Then $g \circ f$ is a function from $x$ into $z$.
    \end{proposition}
    \begin{proof}
      $g \circ f$ is a function of $x$.

      Let us show that $g \circ f$ is one to one.
        Let $u,u' \in x$.
        Assume $(g \circ f)(u) = (g \circ f)(u')$.
        Then $g(f(u)) = g(f(u'))$.
        Hence $f(u) = f(u')$.
        Indeed $f(u), f(u') \in y$.
        Thus $u = u'$.
      End.
    \end{proof}

    \begin{corollary}[SF 02 01 627406]
      Let $f$ be a bijection between $x$ and $y$ and $g$ be a bijection between $y$ and $z$.
      Then $g \circ f$ is a bijection between $x$ and $z$.
    \end{corollary}
    \begin{proof}
      $g \circ f$ is a function from $x$ onto $z$ and a function into $z$.
      Hence the thesis.
    \end{proof}

    \begin{proposition}[SF 02 01 517102]
      Let $w$ be a set.
      Let $f: w \to x$ and $g: x \to y$ and $h: y \to z$.
      Then $h \circ (g \circ f) = (h \circ g) \circ f$.
    \end{proposition}
    \begin{proof}
      $\dom(h \circ (g \circ f)) = \dom(g \circ f) = \dom(f) = w$.
      $\dom((h \circ g) \circ f) = \dom(f) = w$.
      Hence $\dom(h \circ (g \circ f)) = \dom((h \circ g) \circ f)$.

      Let us show that $(h \circ (g \circ f))(u) = ((h \circ g) \circ f)(u)$ for all $u \in w$.
        Let $u \in w$.
        Then
        $$  (h \circ (g \circ f))(u)$$
        $$= h((g \circ f)(u))$$
        $$= h(g(f(u)))$$
        $$= (h \circ g)(f(u))$$
        $$= ((h \circ g) \circ f)(u).$$
      End.

      Thus $h \circ (g \circ f) = (h \circ g) \circ f$ (by function extensionality).
    \end{proof}
  \end{forthel}


  \subsection{Restriction}

  \begin{forthel}
    \begin{lemma}
      Let $a \subseteq \dom(f)$.
      Then there is a function $h$ of $a$ such that $h(u) = f(u)$ for all $u \in a$.
    \end{lemma}
    \begin{proof}
      Define $h(u) = f(u)$ for $u \in a$.
    \end{proof}

    \begin{definition}
      Let $a \subseteq \dom(f)$.
      $f \restr a$ is the function $h$ of $a$ such that $h(u) = f(u)$ for all $u \in a$.
    \end{definition}

    Let the restriction of $f$ to $a$ stand for $f \restr a$.

    \begin{proposition}[SF 02 01 589280]
      Let $f$ be a function from $x$ to $y$ and $a \subseteq x$.
      Then $f \restr a$ is a function from $a$ to $y$.
    \end{proposition}
    \begin{proof}
      We have $\dom(f \restr a) = a$.
      Then $(f \restr a)(u) = f(u) \in y$ for all $u \in a$.
      Hence $f \restr a$ is a function from $a$ to $y$.
    \end{proof}

    \begin{proposition}[SF 02 01 795968]
      Let $a \subseteq x$.
      Then $\id{x} \restr a = \id{a}$.
    \end{proposition}
    \begin{proof}
      We have $\dom(\id{x} \restr a) = a = \dom(\id{a})$.
      $(\id{x} \restr a)(u) = \id{x}(u) = u = \id{a}(u)$ for all $u \in a$.
      Hence the thesis (by function extensionality).
    \end{proof}

    \begin{proposition}[SF 02 01 575265]
      Let $v$ be an element and $a \subseteq x$.
      Then $\const{x}{v} \restr a = \const{a}{v}$.
    \end{proposition}
    \begin{proof}
      We have $\dom(\const{x}{v} \restr a) = a = \dom(\const{a}{v})$.
      $(\const{x}{v} \restr a)(u) = \const{x}{v}(u) = v = \const{a}{v}(u)$ for all $u \in a$.
      Hence the thesis (by function extensionality).
    \end{proof}

    \begin{proposition}[SF 02 01 507691]
      Let $f$ be an one to one function from $x$ to $y$ and $a \subseteq x$.
      Then $f \restr a$ is one to one.
    \end{proposition}
    \begin{proof}
      Let $u,u' \in a$.
      Assume $(f \restr a)(u) = (f \restr a)(u')$.
      Then $f(u) = f(u')$.
      Hence $u = u'$.
    \end{proof}
  \end{forthel}
\end{document}
